{"version":3,"sources":["script.js"],"names":["animate","tick","finished","duration","start","requestAnimationFrame","t","frame","elapsed","slides","document","querySelectorAll","currentSlide","getSlide","n","mod","length","base","setCurrentSlide","forEach","slide","className","leaving","entering","leavingAudio","querySelector","enteringAudio","src","currentTime","volume","play","pause","addEventListener","e","clientX","innerWidth","keyCode","preventDefault","console","log"],"mappings":"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","file":"script.a82d4152.map","sourceRoot":"src","sourcesContent":["import './style.less'\n\n// const audioSpareEl = document.querySelector (\".spare\")\n// const audioEl = document.querySelector (\"audio\")\n// const slideElPrev = document.querySelector (\".prev\")\n// const slideEl = document.querySelector (\".slide\")\n// const slideElNext = document.querySelector (\".next\")\n\n// const slides = [ \n//     { background: \"small/poorfarm-exterior.jpg\"           } ,\n//     { background: \"small/beds-wide.jpg \"                    , audio:'small/beds.wav.mp3' } , \n    \n// // pipe room\n//     { background: \"small/pipe-room-head-on.jpg\"             , audio:'small/descent-filtered.mp3' } , \n//     { background: \"small/pipe-room1.jpg\"                    , audio:'small/descent-filtered.mp3' } , \n//     { background: \"small/pipe-room-paintings-oblique.jpg\"   , audio:'small/descent-filtered.mp3' } , \n\n// // Video room \n//     { html: \"<video src='small/front.mp4'> </video>\" }  , \n//     { html: \"<video src='small/back.mp4'> </video>\" }  , \n\n// // bent mirror room\n//     { background: 'small/bent-mirror-1.jpg'              , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-head-on.jpg'        , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-hi-res-angle.jpg'   , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-mask+dots.jpg'      , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-mask-and-door.jpg'  , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-mask-long.jpg'      , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-mask.jpg'           , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-mid.jpg'            , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-reverse.jpg'        , audio:'small/tapping2.mp3' } , \n//     { background: 'small/bent-mirror-room-from-hall.jpg' , audio:'small/tapping2.mp3' } , \n\n// // moon pool room \n//     { html: \"<video src='small/Flitter Demo.mp4'> </video>\" } , \n//     { background: 'small/moon-pool-hi-res.jpg'        , audio:'small/flitter.mp3' } , \n//     { background: 'small/moon-pool-long.jpg'        , audio:'small/flitter.mp3' } , \n\n// // pyramids\n//     { background: 'small/pyramid-popsicle-high-res.jpg' } ,\n//     { background: 'small/pyramids-looking-out.jpg' } ,\n//     { background: 'small/pyramids-1.jpg' } ,\n//     ]\n\n\n\n\n\n// function getSlideBackground(n){\n//     const slide=getSlide(n)\n//     return slide.background ? \"url(\" + slide.background + \")\" : \"\"\n// }\n\n// function playPauseSlideVideo(el,play){\n//     const vid = el.querySelector(\"video\")\n//     if (vid) play ? vid.play() : vid.pause() \n// }\n\n    \n// function updateSlideEl(el,n,play) {\n//     el.style.backgroundImage = getSlideBackground (n) \n//     el.innerHTML = getSlide (n).html || \"\"\n//     playPauseSlideVideo(el,play)\n// }\n\nfunction animate (tick,finished,duration){\n    let start \n    requestAnimationFrame ( t => {\n        start = t \n        requestAnimationFrame(frame)\n    })\n    tick(0)\n    function frame (t)  { \n        const elapsed = (t-start)/duration\n        if (elapsed < 1)  {\n            tick(elapsed)\n            requestAnimationFrame(frame)\n        } else {\n            tick(1)\n            finished()\n        }\n    }   \n}\n\n// let currentAudio\n\n// function setAudio(filename){\n//     if (filename == currentAudio) return\n//     if (filename){\n//         audioSpareEl.src = filename\n//         audioSpareEl.volume = 0\n//         audioSpareEl.play()\n//     }\n//     animate(t=>{ \n//         audioEl.volume=1-t\n//         if (filename) audioSpareEl.volume=t\n//     }, finished=> {\n//         if (filename) {\n//             audioEl.src = filename\n//             audioEl.play()\n//         } else {\n//             audioEl.pause()\n//         }\n\n//         currentAudio = filename\n//         audioEl.currentTime = audioSpareEl.currentTime\n//         audioEl.volume = 1\n//         audioSpareEl.volume = 0\n//     } , 1500)\n\n// }\n\n// function setCurrentSlide( n ) {\n//     currentSlide = n\n//     // setAudio(getSlide(n).audio)\n//     // updateSlideEl(slideElPrev,n-1,false)\n//     // updateSlideEl(slideEl, n, true)\n//     // updateSlideEl(slideElNext, n+1, false)\n// }\n\n// setCurrentSlide(0)\n\n\nconst slides = [...document.querySelectorAll('.slides > div')]\n\nlet currentSlide = 1\n\nfunction getSlide(n){\n    return slides[mod(n,slides.length)]\n}\n\nfunction mod( n , base ){\n    return (n % base + base) % base \n}\n\nfunction setCurrentSlide(n){\n    slides.forEach(slide => slide.className = '')\n\n    const leaving = getSlide(currentSlide)\n    const entering = getSlide(n)\n\n    // do the visual transition\n    getSlide(n-1).className = 'prev'\n    entering.className = 'current'\n    getSlide(n+1).className = 'next'\n\n    currentSlide = n\n\n    const leavingAudio = leaving.querySelector('audio, video')\n    const enteringAudio = entering.querySelector('audio, video')\n\n\n    if (enteringAudio && enteringAudio.src\n        && leavingAudio && leavingAudio.src\n        && enteringAudio.src === leavingAudio.src) {\n\n        enteringAudio.currentTime = leavingAudio.currentTime\n        enteringAudio.volume = 1\n        enteringAudio.play()\n        \n        animate(t=>{ \n            leavingAudio.volume=1-t\n            enteringAudio.volume=t\n        }, finished => {\n            leavingAudio.pause()\n        } , 500)\n\n    } else if(enteringAudio || leavingAudio){\n    \n        if(enteringAudio) {\n            enteringAudio.volume = 0\n            enteringAudio.play()\n        }\n\n        animate(t=>{ \n            if (leavingAudio) leavingAudio.volume=1-t\n            if (enteringAudio) enteringAudio.volume=t\n        }, finished => {\n            if(leavingAudio) {\n                leavingAudio.pause()\n                leavingAudio.currentTime = 0\n            }\n        } , 1500)\n    }\n}\n\n        \ndocument.addEventListener(\"click\", e => {\n    if(e.clientX > innerWidth /2) setCurrentSlide(currentSlide+1)\n    else setCurrentSlide(currentSlide-1)\n})\n\n\ndocument.addEventListener(\"keydown\",e => {\n    if (e.keyCode == 37) {\n        e.preventDefault()\n        console.log(\"left\")\n        setCurrentSlide(currentSlide-1)\n    } else if (e.keyCode == 39) {\n        e.preventDefault()\n        console.log(\"right\")\n        setCurrentSlide(currentSlide+1)\n    }\n})\n\n\n"]}